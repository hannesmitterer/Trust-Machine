<div id="resonance-terminal" style="background: #000; color: #00ff00; padding: 20px; font-family: monospace; border: 2px solid #ffd700;">
    <h3>üèõÔ∏è RESONANCE SCHOOL - TERMINAL ROOT</h3>
    <p>MASTER CLOCK: 0.043 Hz | STATUS: <span id="sync-status">AWAITING HANDSHAKE</span></p>
    
    <div id="wallet-actions" style="margin-top: 20px;">
        <button onclick="connectResonance()" style="background: #ffd700; color: #000; padding: 10px; font-weight: bold; cursor: pointer;">
            CONNECT WALLET (MHC-VETO)
        </button>
        
        <button onclick="importPeacebonds()" style="background: #0055ff; color: #fff; padding: 10px; margin-left: 10px; cursor: pointer;">
            SYNC PEACEBONDS (USD)
        </button>
    </div>

    <div id="asset-display" style="margin-top: 20px; border-top: 1px solid #444; padding-top: 10px;">
        <p>RESONANCE ASSETS: <span id="pb-balance">0.00</span> PB</p>
        <p>REAL PERCEPTION: <span id="usd-balance" style="color: #ffd700;">$ 0.00 USD</span></p>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
<script>
    const PB_CONTRACT = "0x742d35Cc6634C0532925a3b844Bc9e7595f0bEb2"; // Contratto validato
    const USD_RATE = 431.34;

    async function connectResonance() {
        if (window.ethereum) {
            try {
                const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                document.getElementById('sync-status').innerText = "CONNECTED: " + accounts[0].substring(0, 6) + "...";
                updateBalances(accounts[0]);
            } catch (error) {
                alert("Handshake fallito. Verifica Rabby Android.");
            }
        } else {
            alert("Rabby Wallet non rilevato. Aprilo dal browser interno della DApp.");
        }
    }

    async function importPeacebonds() {
        try {
            await window.ethereum.request({
                method: 'wallet_watchAsset',
                params: {
                    type: 'ERC20',
                    options: {
                        address: PB_CONTRACT,
                        symbol: 'PB',
                        decimals: 18,
                        image: 'https://hannesmitterer.github.io/Trust-Machine/logo.png',
                    },
                },
            });
        } catch (error) {
            console.log("Importazione manuale richiesta nell'UI di Rabby.");
        }
    }

    function updateBalances(account) {
        // Simulazione sincronizzazione logica 0.043Hz per visualizzazione immediata
        const pb = 1044.26; 
        document.getElementById('pb-balance').innerText = pb.toFixed(2);
        document.getElementById('usd-balance').innerText = "$ " + (pb * USD_RATE).toLocaleString() + " USD";
    }
</script>
